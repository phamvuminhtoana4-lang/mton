<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Shop Acc Toàn</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#020617;color:#fff}
header{display:flex;align-items:center;padding:10px;border-bottom:1px solid #1e293b}
#menuBtn{font-size:22px;cursor:pointer}
#userBox{margin-left:auto;font-size:14px}
#side{position:fixed;top:0;left:-260px;width:250px;height:100%;background:#020617;border-right:1px solid #1e293b;transition:.3s;padding-top:60px}
#side a{display:block;padding:12px;border-bottom:1px solid #1e293b;cursor:pointer}
.container{padding:15px}
.view{display:none}
.view.active{display:block}
.card{border:1px solid #1e293b;border-radius:10px;padding:12px;margin-bottom:12px}
input,select,textarea{width:100%;padding:8px;margin:5px 0;border-radius:6px;border:none}
button{padding:8px;border-radius:6px;border:none;background:#fde047;font-weight:bold;cursor:pointer}
img{max-width:100%;border-radius:8px}
.small{font-size:12px;color:#cbd5f5}
.badge{padding:2px 6px;border-radius:4px;font-size:12px}
.wait{background:#facc15;color:#000}
.ok{background:#22c55e}
.err{background:#ef4444}
</style>
</head>

<body>

<header>
<span id="menuBtn" onclick="toggle()">☰</span>
<b style="margin-left:10px">SHOP ACC TOÀN</b>
<div id="userBox">Chưa đăng nhập</div>
</header>

<div id="side">
<a onclick="go('home')">Trang chính</a>
<a onclick="go('nap')">Nạp tiền</a>
<a onclick="go('vip')">Acc VIP</a>
<a onclick="go('white')">Acc Trắng TT</a>
<a onclick="go('hisNap')">Lịch sử nạp</a>
<a onclick="go('hisBuy')">Lịch sử mua</a>
<a id="adminMenu" style="display:none" onclick="go('admin')">ADMIN</a>
<a onclick="logout()">Đăng xuất</a>
</div>

<div class="container">

<!-- HOME -->
<div id="home" class="view active">
<div class="card">
<h3>Đăng ký</h3>
<input id="rUser" placeholder="Tên tài khoản">
<input id="rPass" type="password" placeholder="Mật khẩu">
<input id="rPass2" type="password" placeholder="Nhập lại mật khẩu">
<button onclick="register()">Đăng ký</button>
</div>

<div class="card">
<h3>Đăng nhập</h3>
<input id="lUser" placeholder="Tên tài khoản">
<input id="lPass" type="password" placeholder="Mật khẩu">
<button onclick="login()">Đăng nhập</button>
</div>
</div>

<!-- NẠP -->
<div id="nap" class="view">
<div class="card">
<h3>Nạp thẻ cào</h3>

<select id="menhgia">
  <option value="10000">10.000đ</option>
  <option value="20000">20.000đ</option>
  <option value="50000">50.000đ</option>
  <option value="100000">100.000đ</option>
  <option value="200000">200.000đ</option>
  <option value="500000">500.000đ</option>
  <option value="1000000">1.000.000đ</option>
</select>

<input id="seri" placeholder="Seri thẻ">
<input id="mathe" placeholder="Mã thẻ">
<button onclick="napThe()">Gửi thẻ</button>
</div>

<div class="card">
<h3>Chuyển khoản ngân hàng</h3>
<b>Viettel Money</b><br>
STK: <b>9704229201718425041</b><br>
Nội dung CK: <b id="ckNoiDung"></b>
</div>
</div>

<!-- SHOP -->
<div id="vip" class="view"></div>
<div id="white" class="view"></div>

<!-- LỊCH SỬ -->
<div id="hisNap" class="view"></div>
<div id="hisBuy" class="view"></div>

<!-- ADMIN -->
<div id="admin" class="view">
<div class="card">
<h3>Up acc</h3>
<input id="aname" placeholder="Tên acc">
<input id="auser" placeholder="Tài khoản acc">
<input id="apass" placeholder="Mật khẩu acc">
<input id="aprice" placeholder="Giá acc">
<textarea id="anote" placeholder="Ghi chú acc"></textarea>
<select id="atype">
<option value="vip">Acc VIP</option>
<option value="white">Acc Trắng Thông Tin</option>
</select>
<input type="file" onchange="loadImg(event)">
<img id="preview">
<button onclick="addAcc()">Thêm acc</button>
</div>

<div class="card">
<h3>Duyệt nạp tiền</h3>
<div id="adminNap"></div>
</div>

<div class="card">
<h3>Duyệt mua acc</h3>
<div id="adminBuy"></div>
</div>
</div>

</div>

<script>
const ADMIN_USER="admin",ADMIN_PASS="Pvmt207#";
let users=JSON.parse(localStorage.users||"{}");
let accs=JSON.parse(localStorage.accs||"[]");
let naps=JSON.parse(localStorage.naps||"[]");
let buys=JSON.parse(localStorage.buys||"[]");
let cur=null,isAdmin=false,img="";

function toggle(){side.style.left=side.style.left=="0px"?"-260px":"0px"}

function go(v){
 if(!cur && v!="home") return alert("Vui lòng đăng nhập");
 document.querySelectorAll('.view').forEach(x=>x.classList.remove("active"));
 document.getElementById(v).classList.add("active");
 if(v=="vip")renderShop("vip");
 if(v=="white")renderShop("white");
 if(v=="hisNap")renderNap();
 if(v=="hisBuy")renderBuy();
 if(v=="admin")renderAdmin();
 side.style.left="-260px";
}

function register(){
 if(!rUser.value||!rPass.value||!rPass2.value) return alert("Nhập đủ thông tin");
 if(rPass.value!=rPass2.value) return alert("Mật khẩu không khớp");
 if(users[rUser.value]) return alert("Tài khoản đã tồn tại");
 users[rUser.value]={pass:rPass.value,b:0};
 localStorage.users=JSON.stringify(users);
 alert("Đăng ký thành công");
}

function login(){
 if(lUser.value==ADMIN_USER && lPass.value==ADMIN_PASS){
  cur="ADMIN";isAdmin=true;
  adminMenu.style.display="block";
  userBox.innerText="ADMIN";
  go("admin");return;
 }
 if(!users[lUser.value]||users[lUser.value].pass!=lPass.value) return alert("Sai tài khoản hoặc mật khẩu");
 cur=lUser.value;
 userBox.innerText=cur+" | "+users[cur].b+"đ";
 ckNoiDung.innerText="NAP_"+cur;
 go("nap");
}

function logout(){location.reload()}

function napThe(){
 naps.push({u:cur,mg:menhgia.value,seri:seri.value,ma:mathe.value,st:"Chờ duyệt"});
 localStorage.naps=JSON.stringify(naps);
 alert("Đã gửi thẻ, chờ admin duyệt");
}

function renderNap(){
 hisNap.innerHTML="";
 naps.filter(n=>n.u==cur).forEach(n=>{
  hisNap.innerHTML+=`
  <div class="card">
   ${Number(n.mg).toLocaleString()}đ -
   <span class="badge ${n.st=='Chờ duyệt'?'wait':n.st=='Đã duyệt'?'ok':'err'}">${n.st}</span>
  </div>`;
 });
}

function loadImg(e){
 let r=new FileReader();
 r.onload=()=>{img=r.result;preview.src=img};
 r.readAsDataURL(e.target.files[0]);
}

function addAcc(){
 accs.push({name:aname.value,user:auser.value,pass:apass.value,price:aprice.value,note:anote.value,type:atype.value,img});
 localStorage.accs=JSON.stringify(accs);
 alert("Đã thêm acc");
}

function renderShop(t){
 let box=document.getElementById(t);
 box.innerHTML="";
 accs.filter(a=>a.type==t).forEach((a,i)=>{
  box.innerHTML+=`
  <div class="card">
   <img src="${a.img}">
   <b>${a.name}</b><br>
   ${a.price}đ<br>
   <span class="small">${a.note}</span><br>
   <button onclick="buy(${i})">Mua</button>
  </div>`;
 });
}

function buy(i){
 buys.push({u:cur,i,st:"Chờ giao"});
 localStorage.buys=JSON.stringify(buys);
 alert("Đã mua, chờ admin giao acc");
}

function renderBuy(){
 hisBuy.innerHTML="";
 buys.filter(b=>b.u==cur).forEach(b=>{
  let a=accs[b.i];
  hisBuy.innerHTML+=`
  <div class="card">
   ${a.name} - ${b.st}
   ${b.st=="Thành công"?`<hr>TK:${a.user}<br>MK:${a.pass}<br>${a.note}`:""}
  </div>`;
 });
}

function renderAdmin(){
 adminNap.innerHTML="";
 naps.forEach((n,i)=>{
  if(n.st=="Chờ duyệt")
   adminNap.innerHTML+=`
   <div class="card">
    ${n.u} - ${Number(n.mg).toLocaleString()}đ
    <button onclick="duyetNap(${i})">Duyệt</button>
    <button onclick="saiNap(${i})">Sai thẻ</button>
   </div>`;
 });
 adminBuy.innerHTML="";
 buys.forEach((b,i)=>{
  if(b.st=="Chờ giao")
   adminBuy.innerHTML+=`
   <div class="card">
    ${b.u}
    <button onclick="duyetBuy(${i})">Giao acc</button>
   </div>`;
 });
}

function duyetNap(i){
 users[naps[i].u].b+=Number(naps[i].mg);
 naps[i].st="Đã duyệt";
 localStorage.users=JSON.stringify(users);
 localStorage.naps=JSON.stringify(naps);
 renderAdmin();
}

function saiNap(i){
 naps[i].st="Sai thẻ";
 localStorage.naps=JSON.stringify(naps);
 renderAdmin();
}

function duyetBuy(i){
 buys[i].st="Thành công";
 localStorage.buys=JSON.stringify(buys);
 renderAdmin();
}
</script>

</body>
</html>
