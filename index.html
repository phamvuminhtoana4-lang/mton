<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Shop Acc To√†n</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#020617;color:#fff}
header{display:flex;align-items:center;padding:10px;border-bottom:1px solid #1e293b}
#menuBtn{font-size:22px;cursor:pointer}
#userBox{margin-left:auto;font-size:14px}
#balanceBox{margin-left:10px;font-size:13px;color:#fde047}
#side{position:fixed;top:0;left:-260px;width:250px;height:100%;background:#020617;border-right:1px solid #1e293b;transition:.3s;padding-top:60px;z-index:9}
#side a{display:block;padding:12px;border-bottom:1px solid #1e293b;cursor:pointer}
.container{padding:15px}
.view{display:none}
.view.active{display:block}
.card{border:1px solid #1e293b;border-radius:10px;padding:12px;margin-bottom:12px}
input,select,textarea{width:100%;padding:8px;margin:5px 0;border-radius:6px;border:none}
button{padding:8px;border-radius:6px;border:none;background:#fde047;font-weight:bold;cursor:pointer}
img{max-width:100%;border-radius:8px}
.small{font-size:12px;color:#cbd5f5}
.adminDel{background:#ef4444;color:#fff;margin-left:5px}

/* AI */
#aiBox{position:fixed;bottom:10px;right:10px;width:260px;background:#020617;border:1px solid #1e293b;border-radius:10px}
#aiHead{padding:6px;background:#1e293b;cursor:pointer}
#aiBody{padding:6px}
.chat{height:180px;overflow:auto;border:1px solid #1e293b;padding:5px;margin-bottom:5px}
.ai{color:#22c55e}
.user{color:#fde047}
</style>
</head>

<body>

<header>
<span id="menuBtn" onclick="toggle()">‚ò∞</span>
<b style="margin-left:10px">SHOP ACC TO√ÄN</b>
<div id="userBox">Ch∆∞a ƒëƒÉng nh·∫≠p</div>
<div id="balanceBox"></div>
</header>

<div id="side">
<a onclick="go('home')">Trang ch√≠nh</a>
<a onclick="go('nap')">N·∫°p ti·ªÅn</a>
<a onclick="go('vip')">Acc VIP</a>
<a onclick="go('white')">Acc Tr·∫Øng TT</a>
<a onclick="go('blind')">Acc T√∫i M√π</a>
<a onclick="go('hisNap')">L·ªãch s·ª≠ n·∫°p</a>
<a onclick="go('hisBuy')">L·ªãch s·ª≠ mua</a>
<a onclick="window.open('https://www.facebook.com/share/1DVxeshD6L/','_blank')">Facebook Admin</a>
<a id="adminMenu" style="display:none" onclick="go('admin')">ADMIN</a>
<a onclick="logout()">ƒêƒÉng xu·∫•t</a>
</div>

<div class="container">

<div id="home" class="view active">
<div class="card">
<h3>ƒêƒÉng k√Ω</h3>
<input id="rUser" placeholder="T√™n t√†i kho·∫£n">
<input id="rPass" type="password" placeholder="M·∫≠t kh·∫©u">
<input id="rPass2" type="password" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u">
<button onclick="register()">ƒêƒÉng k√Ω</button>
</div>

<div class="card">
<h3>ƒêƒÉng nh·∫≠p</h3>
<input id="lUser" placeholder="T√™n t√†i kho·∫£n">
<input id="lPass" type="password" placeholder="M·∫≠t kh·∫©u">
<button onclick="login()">ƒêƒÉng nh·∫≠p</button>
</div>
</div>

<div id="nap" class="view">
<div class="card">
<h3>N·∫°p th·∫ª c√†o</h3>
<select id="menhgia">
<option value="10000">10.000</option>
<option value="20000">20.000</option>
<option value="50000">50.000</option>
<option value="100000">100.000</option>
<option value="200000">200.000</option>
<option value="500000">500.000</option>
<option value="1000000">1.000.000</option>
</select>
<input id="seri" placeholder="Seri th·∫ª">
<input id="mathe" placeholder="M√£ th·∫ª">
<button onclick="napThe()">G·ª≠i th·∫ª</button>
</div>

<div class="card">
<h3>Chuy·ªÉn kho·∫£n</h3>
<b>Viettel Money</b><br>
STK: <b>9704229201718425041</b><br>
N·ªôi dung CK:
<b id="ckNoiDung"></b>
<button onclick="copyCK()">üìã Copy</button>
</div>
</div>

<div id="vip" class="view"></div>
<div id="white" class="view"></div>
<div id="blind" class="view"></div>
<div id="hisNap" class="view"></div>
<div id="hisBuy" class="view"></div>

<div id="admin" class="view">
<div class="card">
<h3>Duy·ªát n·∫°p th·∫ª</h3>
<div id="adminNap"></div>
</div>

<div class="card">
<h3>Duy·ªát mua acc</h3>
<div id="adminBuy"></div>
</div>

<div class="card">
<h3>C·ªông ti·ªÅn th·ªß c√¥ng</h3>
<input id="addUser" placeholder="T√™n t√†i kho·∫£n">
<input id="addMoney" type="number" placeholder="S·ªë ti·ªÅn">
<input id="addNote" placeholder="N·ªôi dung chuy·ªÉn kho·∫£n">
<button onclick="adminAddMoney()">C·ªông ti·ªÅn</button>
</div>

<div class="card">
<h3>Up acc</h3>
<input id="aname" placeholder="T√™n acc">
<input id="auser" placeholder="TK acc">
<input id="apass" placeholder="MK acc">
<input id="aprice" placeholder="Gi√°">
<textarea id="anote" placeholder="Ghi ch√∫"></textarea>
<select id="atype">
<option value="vip">VIP</option>
<option value="white">Tr·∫Øng TT</option>
<option value="blind">T√∫i M√π</option>
</select>
<input type="file" onchange="loadImg(event)">
<img id="preview">
<button onclick="addAcc()">Th√™m acc</button>
</div>
</div>

</div>

<div id="aiBox">
<div id="aiHead" onclick="toggleAI()">ü§ñ AI h·ªó tr·ª£</div>
<div id="aiBody">
<div id="chat" class="chat"></div>
<input id="ask" placeholder="H·ªèi AI..." onkeydown="if(event.key==='Enter')sendAI()">
<button onclick="sendAI()">G·ª≠i</button>
</div>
</div>

<script>
const ADMIN_USER="admin",ADMIN_PASS="Pvmt207#";
let users=JSON.parse(localStorage.users||"{}");
let accs=JSON.parse(localStorage.accs||"[]");
let naps=JSON.parse(localStorage.naps||"[]");
let buys=JSON.parse(localStorage.buys||"[]");
let cur=null,img="";

function updateBalance(){
 if(cur && users[cur]) balanceBox.innerText="S·ªë d∆∞: "+users[cur].b+"ƒë";
 else balanceBox.innerText="";
}
function toggle(){side.style.left=side.style.left=="0px"?"-260px":"0px"}
function go(v){
 if(!cur&&v!="home")return alert("ƒêƒÉng nh·∫≠p tr∆∞·ªõc");
 document.querySelectorAll('.view').forEach(x=>x.classList.remove("active"));
 document.getElementById(v).classList.add("active");
 if(v=="vip")renderShop("vip");
 if(v=="white")renderShop("white");
 if(v=="blind")renderShop("blind");
 if(v=="hisNap")renderNap();
 if(v=="hisBuy")renderBuy();
 if(v=="admin")renderAdmin();
 side.style.left="-260px";
}

function register(){
 let u=rUser.value.trim().toLowerCase();
 if(!u||!rPass.value||!rPass2.value)return alert("Thi·∫øu th√¥ng tin");
 if(rPass.value!=rPass2.value)return alert("M·∫≠t kh·∫©u kh√¥ng kh·ªõp");
 if(users[u])return alert("T√™n t√†i kho·∫£n ƒë√£ t·ªìn t·∫°i");
 users[u]={pass:rPass.value,b:0};
 localStorage.users=JSON.stringify(users);
 alert("ƒêƒÉng k√Ω th√†nh c√¥ng");
}

function login(){
 let u=lUser.value.trim().toLowerCase();
 if(u==ADMIN_USER&&lPass.value==ADMIN_PASS){
  cur="ADMIN";
  adminMenu.style.display="block";
  userBox.innerText="ADMIN";
  updateBalance();
  go("admin");return;
 }
 if(!users[u]||users[u].pass!=lPass.value)return alert("Sai th√¥ng tin");
 cur=u;
 userBox.innerText=cur+" | "+users[cur].b+"ƒë";
 ckNoiDung.innerText="NAP_"+cur;
 updateBalance();
 go("nap");
}
function logout(){location.reload()}

function napThe(){
 naps.push({u:cur,mg:+menhgia.value,seri:seri.value,mathe:mathe.value,nd:"NAP_"+cur,st:"Ch·ªù"});
 localStorage.naps=JSON.stringify(naps);
 alert("ƒê√£ g·ª≠i th·∫ª");
}
function renderNap(){
 hisNap.innerHTML="";
 naps.filter(n=>n.u==cur).forEach(n=>{
  hisNap.innerHTML+=`<div class="card">${n.mg}ƒë - ${n.st}<br>${n.nd||""}</div>`;
 });
}

function renderShop(t){
 let box=document.getElementById(t);box.innerHTML="";
 accs.filter(a=>a.type==t).forEach((a,i)=>{
  box.innerHTML+=`
  <div class="card">
   <img src="${a.img}">
   <b>${a.name}</b><br>${a.price}ƒë<br>
   <span class="small">${a.note}</span><br>
   ${t=="blind"
     ? `<button onclick="buyBlind(${i})">Mua t√∫i m√π</button>`
     : `<button onclick="buy(${i})">Mua</button>`}
   ${cur==="ADMIN"?`<button class="adminDel" onclick="delAcc(${i})">‚ùå</button>`:""}
  </div>`;
 });
}
function buy(i){
 buys.push({u:cur,acc:accs[i],st:"Ch·ªù"});
 localStorage.buys=JSON.stringify(buys);
 alert("ƒê√£ g·ª≠i y√™u c·∫ßu mua");
}
function buyBlind(i){
 let a=accs[i];
 if(users[cur].b<a.price)return alert("Kh√¥ng ƒë·ªß ti·ªÅn");
 users[cur].b-=a.price;
 buys.push({u:cur,acc:{name:a.name,user:"·∫®n",pass:"·∫®n"},st:"Ch·ªù"});
 localStorage.users=JSON.stringify(users);
 localStorage.buys=JSON.stringify(buys);
 updateBalance();
 alert("ƒê√£ mua acc t√∫i m√π");
}

function renderBuy(){
 hisBuy.innerHTML="";
 buys.filter(b=>b.u==cur).forEach(b=>{
  hisBuy.innerHTML+=`<div class="card">${b.acc.name} - ${b.st}
  ${b.st=="Duy·ªát"?`<hr>TK:${b.acc.user}<br>MK:${b.acc.pass}`:""}</div>`;
 });
}

function renderAdmin(){
 adminNap.innerHTML="";
 naps.forEach((n,i)=>{
  if(n.st!="Ch·ªù")return;
  adminNap.innerHTML+=`
  <div class="card">${n.u} - ${n.mg}ƒë<br>${n.nd}
  <button onclick="duyetNap(${i})">Duy·ªát</button>
  <button onclick="saiNap(${i})">Sai</button>
  </div>`;
 });
 renderAdminCay();
}
function duyetNap(i){
 let n=naps[i];
 n.st="Duy·ªát";
 users[n.u].b+=n.mg;
 localStorage.users=JSON.stringify(users);
 localStorage.naps=JSON.stringify(naps);
 if(n.u===cur)updateBalance();
 renderAdmin();
}
function saiNap(i){
 naps[i].st="Sai";
 localStorage.naps=JSON.stringify(naps);
 renderAdmin();
}
function adminAddMoney(){
 let u=addUser.value,m=+addMoney.value,nd=addNote.value;
 if(!users[u]||m<=0)return alert("L·ªói d·ªØ li·ªáu");
 users[u].b+=m;
 naps.push({u,mg:m,nd,st:"ADMIN C·ªòNG"});
 localStorage.users=JSON.stringify(users);
 localStorage.naps=JSON.stringify(naps);
 alert("ƒê√£ c·ªông ti·ªÅn");
 renderAdmin();
}
function delAcc(i){
 accs.splice(i,1);
 localStorage.accs=JSON.stringify(accs);
 alert("ƒê√£ x√≥a acc");
}

function loadImg(e){
 let r=new FileReader();
 r.onload=()=>{img=r.result;preview.src=img};
 r.readAsDataURL(e.target.files[0]);
}
function addAcc(){
 accs.push({name:aname.value,user:auser.value,pass:apass.value,price:+aprice.value,note:anote.value,type:atype.value,img});
 localStorage.accs=JSON.stringify(accs);
 alert("ƒê√£ th√™m acc");
}

function copyCK(){
 navigator.clipboard.writeText(ckNoiDung.innerText);
 alert("ƒê√£ copy n·ªôi dung CK");
}

const bannedWords=["m·∫≠t kh·∫©u","password","pass","admin","ch·ªß shop","acc ch∆∞a b√°n","tk acc","database","n·ªôi b·ªô","hack","bypass","s·ªë d∆∞ ng∆∞·ªùi kh√°c"];
const aiAnswers={
 greet:["Ch√†o b·∫°n üëã M√¨nh h·ªó tr·ª£ n·∫°p ti·ªÅn v√† mua acc nh√©.","Xin ch√†o üòÑ B·∫°n c·∫ßn h·ªó tr·ª£ g√¨ v·ªÅ shop kh√¥ng?"],
 nap:["B·∫°n v√†o m·ª•c N·∫°p ti·ªÅn v√† l√†m theo h∆∞·ªõng d·∫´n.","Sau khi n·∫°p, admin s·∫Ω duy·ªát v√† c·ªông ti·ªÅn."],
 buy:["B·∫°n ch·ªçn acc ph√π h·ª£p r·ªìi b·∫•m mua nh√©.","Sau khi duy·ªát, th√¥ng tin acc s·∫Ω hi·ªán trong l·ªãch s·ª≠ mua."],
 error:["B·∫°n th·ª≠ t·∫£i l·∫°i trang v√† thao t√°c l·∫°i nh√©.","N·∫øu v·∫´n l·ªói, b·∫°n li√™n h·ªá admin ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£."],
 refuse:["Xin l·ªói, th√¥ng tin n√†y m√¨nh kh√¥ng th·ªÉ cung c·∫•p.","ƒê√¢y l√† th√¥ng tin n·ªôi b·ªô c·ªßa shop."]
};
function rand(a){return a[Math.floor(Math.random()*a.length)]}
function aiReply(q){
 q=q.toLowerCase();
 for(let w of bannedWords){if(q.includes(w)) return rand(aiAnswers.refuse);}
 if(q.includes("ch√†o")||q.includes("hi")) return rand(aiAnswers.greet);
 if(q.includes("n·∫°p")||q.includes("th·∫ª")||q.includes("chuy·ªÉn")) return rand(aiAnswers.nap);
 if(q.includes("mua")||q.includes("acc")) return rand(aiAnswers.buy);
 if(q.includes("l·ªói")||q.includes("sai")) return rand(aiAnswers.error);
 return "M√¨nh ch·ªâ h·ªó tr·ª£ c√°c c√¢u h·ªèi chung v·ªÅ shop nh√© üôÇ";
}
function toggleAI(){aiBody.style.display=aiBody.style.display=="none"?"block":"none";}
function sendAI(){
 if(!ask.value)return;
 chat.innerHTML+=`<div class="user">B·∫°n: ${ask.value}</div>`;
 chat.innerHTML+=`<div class="ai">AI: ${aiReply(ask.value)}</div>`;
 ask.value="";
 chat.scrollTop=9999;
}

/* ================= TH√äM C√ÄY THU√ä ================= */
let cayThue=JSON.parse(localStorage.cayThue||"[]");

document.addEventListener("DOMContentLoaded",()=>{
 let a=document.createElement("a");
 a.innerText="C√†y thu√™";
 a.onclick=()=>go("caythue");
 side.insertBefore(a,side.children[5]);

 let v=document.createElement("div");
 v.id="caythue";
 v.className="view";
 v.innerHTML=`
 <div class="card">
  <h3>C√†y thu√™</h3>
  <input id="ctUser" placeholder="T√†i kho·∫£n game">
  <input id="ctPass" placeholder="M·∫≠t kh·∫©u game">
  <textarea id="ctNote" placeholder="N·ªôi dung c√†y"></textarea>
  <button onclick="guiCay()">G·ª≠i y√™u c·∫ßu</button>
 </div>
 <div class="card">
  <h3>Y√™u c·∫ßu c·ªßa b·∫°n</h3>
  <div id="ctHis"></div>
 </div>`;
 document.querySelector(".container").appendChild(v);

 let ac=document.createElement("div");
 ac.className="card";
 ac.innerHTML=`<h3>Duy·ªát c√†y thu√™</h3><div id="adminCay"></div>`;
 document.getElementById("admin").appendChild(ac);
});

function guiCay(){
 if(!ctUser.value||!ctPass.value||!ctNote.value)return alert("Thi·∫øu th√¥ng tin");
 cayThue.push({id:Date.now(),u:cur,acc:ctUser.value,pass:ctPass.value,note:ctNote.value,price:0,st:"Ch·ªù b√°o gi√°"});
 localStorage.cayThue=JSON.stringify(cayThue);
 renderCayUser();
}

function renderCayUser(){
 ctHis.innerHTML="";
 cayThue.filter(c=>c.u==cur).forEach(c=>{
  ctHis.innerHTML+=`
  <div class="card">
   ${c.note}<br>
   Tr·∫°ng th√°i: ${c.st}<br>
   ${c.price?`Gi√°:${c.price}ƒë <button onclick="chapNhan(${c.id})">OK</button>`:""}
  </div>`;
 });
}

function chapNhan(id){
 let c=cayThue.find(x=>x.id==id);
 if(users[cur].b<c.price)return alert("Kh√¥ng ƒë·ªß ti·ªÅn");
 users[cur].b-=c.price;
 c.st="ƒêang c√†y";
 localStorage.users=JSON.stringify(users);
 localStorage.cayThue=JSON.stringify(cayThue);
 updateBalance();
}

function renderAdminCay(){
 if(!document.getElementById("adminCay"))return;
 adminCay.innerHTML="";
 cayThue.forEach((c,i)=>{
  adminCay.innerHTML+=`
  <div class="card">
   ${c.u}<br>
   TK:${c.acc}<br>
   MK:${c.pass}<br>
   ${c.note}<br>
   <input placeholder="Gi√°" onchange="cayThue[${i}].price=this.value">
   <button onclick="baoGia(${i})">B√°o gi√°</button>
   <button onclick="tuChoi(${i})">T·ª´ ch·ªëi</button>
   <button onclick="hoanThanh(${i})">Ho√†n th√†nh</button>
  </div>`;
 });
}

function baoGia(i){cayThue[i].st="ƒê√£ b√°o gi√°";saveCay()}
function tuChoi(i){cayThue[i].st="T·ª´ ch·ªëi";saveCay()}
function hoanThanh(i){cayThue[i].st="Ho√†n th√†nh";saveCay()}
function saveCay(){localStorage.cayThue=JSON.stringify(cayThue);renderAdminCay()}
</script>

</body>
</html>
